<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html lang="ja">
<head>
<title>Sample50</title>
<style type="text/css">
<!--
.frame1{position:absolute;border-width:thick;border-style:double;border-color:gray;width:150;overflow:auto;font-size:11pt;padding:3;}
.frame2{position:absolute;margin-top:0;margin-left:200;visibility:hidden;}
th{paddig:3;background-color:silver;width:100;}
td{font-family:ＭＳ Ｐ明朝,serif;font-size:11pt;line-height:15pt;padding:3;}
-->
</style>
<script type="text/vbscript">
<!--
	option explicit
	dim i,allNo
	dim nennTukihi
	dim nennTukihiNode
	dim eventNode
	dim eventNaiyou()
	dim xmldoc
	dim nenn,tuki,hi,nenn_tuki_hi
	dim dummyNennTukiHi
	dim hannbetu,no
sub window_onload()
		no=0
		set xmldoc=createObject("Microsoft.XMLDom")
		xmldoc.async=false
		redim eventNaiyou(31)
		
	
		'複数のXML文書にアクセスして要素の内容を取り出す（ここではファイル数31個（1ヶ月））
		for i=1 to 31
			xmldoc.load("event" & i & ".xml")
			set nennTukihiNode=xmldoc.getElementsByTagName("年月日")
			set eventNode=xmldoc.getElementsByTagName("イベント情報")
			if nennTukihiNode.length<=0 then exit for
			eventNaiyou(i)=eventNode(0).text
		 	nennTukihi=nennTukihi & "<div style='cursor:hand' id='tukiMenu" & i & "'" & " onclick='go(" & i & ")'>" & nennTukihiNode(0).text & "</div>"
			no=no+1
		next
			tukihi.innerHTML=nennTukihi

			'その日の，年と月と日を別個に取り出し連結させる．
			nenn_tuki_hi= now()
			nenn=year(nenn_tuki_hi)
			tuki=month(nenn_tuki_hi)
			hi=day(nenn_tuki_hi)
			dummyNennTukiHi=nenn & "年" & tuki & "月" & hi & "日"
			
			for i=1 to no

				'連結させたその日の年月日と，表示されている年月日が一致するかどうかを判別する．
				hannbetu=strcomp(document.all("tukiMenu" & i).innerText,dummyNennTukiHi)
			
				'一致すればその日の背景色を銀色にする．
				if hannbetu=0 then
					document.all("tukiMenu" & i).style.backgroundColor="silver"
					naiyou.style.visibility="visible"
					myDate.innerHTML=document.all("tukiMenu" & i).innerText
					myNaiyou.innerHTML=eventNaiyou(i)
				else
						document.all("tukiMenu" & i).style.backgroundColor="white"
				end if
			next	
end sub

sub go(allNo)
	naiyou.style.visibility="visible"
	for i=1 to no
		document.all("tukiMenu" & i).style.backgroundColor="white"
	next
		document.all("tukiMenu" & allNo).style.backgroundColor="silver"

		'マウスのクリックに応じて，変数allNoに対応する内容を表示する．
		myDate.innerHTML=document.all("tukiMenu" & allNo).innerText
		myNaiyou.innerHTML=eventNaiyou(allNo)
end sub

sub goReset()
	window.location.reload()
end sub
-->
</script>
</head>
<body>

<div id="tukihi" class="frame1"></div>
<button style="font-size:11pt;position:absolute;margin-top:70;width:150" onclick="goReset()">Reset</button>
<div id="naiyou" class="frame2">
<table border="1" width="250">
	<tr>
	<th>年月日</th><td colspan="3"><span id="myDate"></span></td>
	</tr>
	<tr>
	<th>イベント情報</th>
	<td colspan="3"><span id="myNaiyou"></span></td>
	</tr>
</table>
</div>
</body>
</html>
