<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html lang="ja">
<head>
<title>Sample49</title>
<script type="text/vbscript">
<!--
option explicit
	dim xmldoc
	dim newElement0,newElement1,newElement2
	dim mytext,space1,space2,space3,space4,space5,space6,space7
	dim space8,space9,space10,space11
	dim nushielement,mainelement,yomielement,namaeelement
	dim yomi,namae

sub window_onload()
	'XML DOMオブジェクトを使えるようにする（お約束）．
	set xmldoc=CreateObject("Microsoft.XMLDom")
	xmldoc.async=false
	'「田舎村」をルート要素に持つXMLのテンプレートを作る．
	xmldoc.loadXML("<?xml version='1.0'?><田舎村/>")
	xmlData.textbox1.value=""
	call alldel()
end sub

sub alldel()
	xmlData.kyssyomi.value=""
	xmlData.kyssnamae.value=""
end sub

sub datainn()
	'要素の間に入れる改行を生成する．
	set space1=xmldoc.createTextNode(chr(13))
	set space2=xmldoc.createTextNode(chr(13))
	set space3=xmldoc.createTextNode(chr(13))
	set space4=xmldoc.createTextNode(chr(13))
	set space5=xmldoc.createTextNode(chr(13))
	set space6=xmldoc.createTextNode(chr(13))
	set space7=xmldoc.createTextNode(chr(13))
	set space8=xmldoc.createTextNode(chr(13))
	set space9=xmldoc.createTextNode(chr(13))
	set space10=xmldoc.createTextNode(chr(13))
	set space11=xmldoc.createTextNode(chr(13))
	
	'それぞれの要素を生成し後に改行を入れる．
	xmldoc.documentElement.appendChild(space1)

	set mainElement=xmldoc.createElement("被保険者")
	mainElement.appendChild(space2)
	xmldoc.documentElement.appendChild(mainElement)
	xmldoc.documentElement.appendChild(space3)

	set nushielement=xmldoc.createElement("世帯主")
	mainElement.appendChild(nushielement)
	mainElement.appendChild(space4)
	nushiElement.appendChild(space5)
	
	set yomielement=xmldoc.createElement("ふりがな")
	nushielement.appendChild(yomielement)
	nushiElement.appendChild(space6)
	yomiElement.appendChild(space7)

	set namaeelement=xmldoc.createElement("氏名")
	nushielement.appendChild(namaeelement)
	nushiElement.appendChild(space8)
	namaeElement.appendChild(space9)
	
	   '生成した要素に内容を追加する．
		yomi=xmlData.kyssyomi.value
		set mytext=xmldoc.createTextNode(yomi)
		yomielement.appendChild(mytext)
		yomielement.appendChild(space10)
	  	
		namae=xmlData.kyssnamae.value
		set mytext=xmldoc.createTextNode(namae)
		namaeelement.appendChild(mytext)
		namaeElement.appendChild(space11)
		
		xmlData.textbox1.value=xmldoc.xml
		call alldel()
end sub

sub styleGo()
	dim xmldoc2,stylesheet,mado
	set xmldoc2=createObject("Microsoft.XMLDom")
	set stylesheet=createObject("Microsoft.XMLDom")

	xmldoc2.async=false
	stylesheet.async=false

	if len(xmlData.textbox1.value)<=0 then
		msgbox "表示できるデータがありません．"
		exit sub
	else

		'テキストエリア内に表示されたXML文書にXSLを関連付けて表示する．
		xmldoc2.loadXML(xmlData.textbox1.value)
		stylesheet.load("sample49.xsl")
		set mado=window.open("")
		mado.document.write(xmldoc2.transformNode(stylesheet))
	end if
		
end sub

-->
</script>
</head>
<body>

<button style="position:absolute;font-family:ＭＳ Ｐ明朝;font-size:11pt;margin-left:300;margin-top:20" onclick="datainn()">ＯＫ</button>

<button style="position:absolute;font-family:ＭＳ Ｐ明朝;font-size:11pt;margin-left:350;margin-top:20" onclick="styleGo()">完了</button>

<form name="xmlData">
読み：<input type="text" name="kyssyomi" size="40" " style="ime-mode:active" />
<br />
名前：<input type="text" name="kyssnamae" size="40" style="ime-mode:active"/>
<br />
<textarea style="font-family:ＭＳ Ｐ明朝;font-size:11pt;margin-left:10;margin-top:30" id="textbox1" rows="20" cols="80"></textarea>
</form>

</body>
</html>
